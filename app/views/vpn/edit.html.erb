<script type="text/javascript">	


// ----------------------------------------------------------------------------
/*
	Password Validator 0.1
	(c) 2007 Steven Levithan <stevenlevithan.com>
	MIT License
*/

function validatePassword (pw, options) {
	// default options (allows any password)
	var o = {
		lower:    1,
		upper:    1,
		alpha:    0, /* lower + upper */
		numeric:  1,
		special:  1,
		length:   [8, Infinity],
		custom:   [ /* regexes and/or functions */ ],
		badWords: ["="],
		badSequenceLength: 0,
		noQwertySequences: false,
		noSequential:      false
	};

	for (var property in options)
		o[property] = options[property];

	var	re = {
			lower:   /[a-z]/g,
			upper:   /[A-Z]/g,
			alpha:   /[A-Z]/gi,
			numeric: /[0-9]/g,
			special: /[\W_]/g
		},
		rule, i;

	// enforce min/max length
	if (pw.length < o.length[0] || pw.length > o.length[1])
		return false;

	// enforce lower/upper/alpha/numeric/special rules
	for (rule in re) {
		if ((pw.match(re[rule]) || []).length < o[rule])
			return false;
	}

	// enforce word ban (case insensitive)
	for (i = 0; i < o.badWords.length; i++) {
		if (pw.toLowerCase().indexOf(o.badWords[i].toLowerCase()) > -1)
			return false;
	}

	// enforce the no sequential, identical characters rule
	if (o.noSequential && /([\S\s])\1/.test(pw))
		return false;

	// enforce alphanumeric/qwerty sequence ban rules
	if (o.badSequenceLength) {
		var	lower   = "abcdefghijklmnopqrstuvwxyz",
			upper   = lower.toUpperCase(),
			numbers = "0123456789",
			qwerty  = "qwertyuiopasdfghjklzxcvbnm",
			start   = o.badSequenceLength - 1,
			seq     = "_" + pw.slice(0, start);
		for (i = start; i < pw.length; i++) {
			seq = seq.slice(1) + pw.charAt(i);
			if (
				lower.indexOf(seq)   > -1 ||
				upper.indexOf(seq)   > -1 ||
				numbers.indexOf(seq) > -1 ||
				(o.noQwertySequences && qwerty.indexOf(seq) > -1)
			) {
				return false;
			}
		}
	}

	// enforce custom regex/function rules
	for (i = 0; i < o.custom.length; i++) {
		rule = o.custom[i];
		if (rule instanceof RegExp) {
			if (!rule.test(pw))
				return false;
		} else if (rule instanceof Function) {
			if (!rule(pw))
				return false;
		}
	}

	// great success!
	return true;
}

// ----------------------------------------------------------------------------


function testPassword(password){
	var pass = String(password);
	var result = validatePassword(pass)
	
	// good password
	if (result == true) {
		alert('good password');
	};

	// bad password
	if(result == false) {
		alert('bad password');
	};
	
}

// ----------------------------------------------------------------------------


</script>


<!-- ====================================================================== -->
<!-- form code here -->

<h2>Edit VPN Password</h2>

<p>VPN password <b><u>must contain the following 4</u></b> attributes,
	<ul>
		<li>Must <u>not</u> contain an "=" sign</li>
		<li>Must be at least 8 characters long</li>
		<li>Must contain 1 of each of the following 4 categories:</li>
			<ul>
				<li>English uppercase (A through Z)</li>
				<li>Base 10 digits</li>
				<li>English lowercase (a through z)</li>
				<li>Non-alphabetic "special" characters. For example: ~!@#$%^&*()_-+|[]{};.,"'/? and spaces</li>
			</ul>
		<li><b>Must <u>NOT</u> contain the Relay username</b></li>
	</ul>
</p>


<%= form_for([@person, @vpn]) do |f| %>
	 <div class="field">
	 		<br/>
	    <%= "VPN Password" %><br/>
	    <%= f.text_field :simple_password, :onChange => "testPassword(this.value);"%>
	    <br/>
	    <br/>
	  </div>
	  <div class="actions">
	    <%= f.submit %>
	  </div>
<% end %>



<%= link_to 'Show', @person %> |
<%= link_to 'Back', people_path %>  


<%= "vpn model object" %><br/>
<%= @vpn.inspect %>